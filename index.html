<!DOCTYPE html>
<html>
<head>
  <title>Secret Task Upload</title>
  <style>
    body { background-color: #f0e68c; font-family: "Comic Sans MS", sans-serif; color: #000080; text-align: center; }
    h1 { color: red; font-size: 36px; text-shadow: 2px 2px yellow; }
    .instructions { border: 3px dashed #ff00ff; padding: 20px; margin: 20px; background-color: #ffffff; }
    select, input[type="file"], button { font-size: 18px; margin: 10px; }
    #status { margin-top: 20px; font-size: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <!-- Rotating banner -->
  <marquee behavior="alternate" scrollamount="10" direction="left">
    <h1>Welcome to the secret task!</h1>
  </marquee>
  <div class="instructions">
    <p><b>Because the players are paired up before the eventual night, the secret task is:</b></p>
    <p>üëâ Take a selfie with any of the other contestants <u>without their knowledge</u> while they are doing something embarrassing.</p>
    <p>üëâ You must have something in the picture that says: <b>"This is for the secret task"</b>.</p>
    <p>‚úÖ Finish uploading by <b>9pm, August 2nd</b>.</p>
    <p>üéâ <b>Bonus points for the funniest picture amongst all collected!</b></p>
  </div>
  <!-- Upload form -->
  <div>
    <label for="player">Select Player:</label>
    <select id="player">
      <option value="Aravind">Aravind</option>
      <option value="Gattu">Gattu</option>
      <option value="Betty">Betty</option>
      <option value="Gurnoor">Gurnoor</option>
    </select>
    <br><br>
    <label for="file">Upload your secret task photo:</label>
    <br>
    <input type="file" id="file" accept="image/*">
    <br><br>
    <button onclick="uploadFile()">Upload Photo</button>
  </div>
  <div id="status"></div>
  <script>
    async function uploadFile() {
      const statusDiv = document.getElementById('status');
      statusDiv.style.color = 'black';
      statusDiv.textContent = '‚è≥ Uploading...';
      const player = document.getElementById('player').value;
      const fileInput = document.getElementById('file');
      if (!fileInput.files.length) {
        statusDiv.style.color = 'red';
        statusDiv.textContent = '‚ùå Please select a file first!';
        return;
      }
      const file = fileInput.files[0];
      const reader = new FileReader();
      reader.onload = async function(e) {
        const base64 = e.target.result.split(',')[1];
        const payload = {
          player: player,
          fileName: file.name,
          fileType: file.type,
          fileData: base64
        };
        try {
          const response = await fetch(
            'https://script.google.com/macros/s/AKfycbxJrvXDsyh_CKNRkgGU82NaVk8yfgGSzIFFyqdhS662/dev',
            {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload)
            }
          );
          const text = await response.text();
          if (text.includes('Error') || text.includes('‚ùå')) {
            statusDiv.style.color = 'red';
            statusDiv.textContent = '‚ùå Upload failed: ' + text;
          } else {
            statusDiv.style.color = 'green';
            statusDiv.textContent = '‚úÖ Upload successful!';
          }
        } catch (err) {
          statusDiv.style.color = 'red';
          statusDiv.textContent = '‚ùå Upload failed: ' + err.message;
        }
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
